---
date: 2025-03-03T18:32:10
---

# 根据指定分布采样

根据指定分布采样，也可以理解为生成指定分布的随机数。

## 逆变换采样

逆变换采样（Inverse Transform Sampling）使用 $[0,1]$ 的均匀分布来生成指定分布的随机数。假设我们要生成服从 $f(x)$ 分布的随机数。其 CDF 为

$$
F(x)=\int_{-\infty}^{+\infty} f(x) \mathrm{d}x
$$

我们的目标是找到一个**单调递增**的转换函数 $T(x)$，使得对于 $X \sim U[0,1]$，有 $T(X) \sim f(x)$。根据 CDF 的定义

$$
F(x)=P(T(X) \le x)=P(X \le T^{-1}(x))
$$

又因为 $X \sim U[0,1]$，所以

$$
P(X \le T^{-1}(x))=T^{-1}(x)
$$

联立前两个式子，得到

$$
T(x)=F^{-1}(x)
$$

因此，只要将 $[0,1]$ 上均匀分布的随机数输入到 $F^{-1}(x)$ 中，就能得到服从 $f(x)$ 分布的随机数。

## 拒绝采样

## 常用采样方法

### 单位圆上均匀采样

利用极坐标生成采样点 $(r,\theta)$。一个典型的错误是让 $r$ 和 $\theta$ 服从均匀分布，得到下图左边的结果，采样点在中心更加密集，并不均匀！

![[Pasted image 20250303220931.png|圆上均匀采样]]

应该让圆上单位面积被采样的概率相等，所以 PDF 为

$$
p(x,y)=\frac{1}{\pi}
$$

[[概率密度函数的坐标系变换|变换]] 到极坐标为

$$
p(r,\theta)=\frac{r}{\pi}
$$

边缘概率密度

$$
\begin{align}
p(r) &= \int_0^{2\pi} p(r,\theta) \mathrm{d}\theta = 2r\\
p(\theta) &= \int_0^1 p(r,\theta) \mathrm{d}r = \frac{1}{2\pi}
\end{align}
$$

计算 CDF

$$
\begin{align}
P(r) &= \int p(r) \mathrm{d}r = r^2\\
P(\theta) &= \int p(\theta) \mathrm{d}\theta = \frac{\theta}{2\pi}
\end{align}
$$

使用逆变换采样，若 $\xi_1,\xi_2$ 为服从 $U[0,1]$ 的随机数，则

$$
\begin{align}
r&=\sqrt{\xi_1}\\
\theta&=2\pi\xi_2
\end{align}
$$

### 单位球面上均匀采样

### 单位半球面上均匀采样

### 单位半球面上余弦权重采样

## 参考

- [随机采样方法之逆变换采样-CSDN博客](https://blog.csdn.net/u011426016/article/details/143351773)
- [多维空间下的均匀采样方法 - 知乎](https://zhuanlan.zhihu.com/p/552773776)
- [渲染与采样（1）：逆变换采样（Inverse Transform Sampling）—原理与实际应用 - 知乎](https://zhuanlan.zhihu.com/p/622443806)
