---
slug: "240422191159"
date: 2024-04-22
---

# 线性微分方程

$$
y^{(n)} + a_1(x)y^{(n - 1)} + \cdots + a_{n - 1}(x)y' + a_n(x)y = f(x)
$$

- **线性：**方程对于未知函数 $y$ 及其导数是一次方程。
- **齐次：** $f(x) \equiv 0$ 。

## 解的结构

### 定理一

如果函数 $y_1(x)$ 与 $y_2(x)$ 是二阶齐次线性方程

$$
y'' + P(x)\,y' + Q(x)\,y = 0
$$

的两个解，那么

$$
y = C_1\,y_1(x) + C_2\,y_2(x)
$$

也是方程的解，其中 $C_1, C_2$ 是任意常数。当且仅当 $y_1(x)$ 与 $y_2(x)$ [[函数组的线性相关|线性相关]] 时，上式为方程的通解。

#### 推论

如果 $y_1(x), y_2(x), \cdots, y_n(x)$ 是 $n$ 阶齐次线性方程

$$
y^{(n)} + a_1\,y^{(n-1)} + \cdots + a_{n-1}\,y' + a_n\,y = 0
$$

的 $n$ 个线性无关的解，那么，此方程的通解为

$$
y = C_1\,y_1(x) + C_2\,y_2(x) + \cdots + C_n\,y_n(x)
$$

其中 $C_1, C_2, \cdots, C_n$ 为任意常数。

### 定理二

设 $y^*(x)$ 是二阶非齐次线性方程

$$
y'' + P(x)\,y' + Q(x)\,y = f(x)
$$

的一个特解。 $Y(x)$ 是对应齐次方程的通解，则

$$
y = Y(x) + y^*(x)
$$

是原方程的通解。（可推广到 $n$ 阶）

### 叠加原理

对于二阶非齐次线性方程

$$
y'' + P(x)\,y' + Q(x)\,y = f_1(x) + f_2(x)
$$

如果 $y_1^*(x)$ 与 $y_2^*(x)$ 分别是方程

$$
y'' + P(x)\,y' + Q(x)\,y = f_1(x)
$$

与

$$
y'' + P(x)\,y' + Q(x)\,y = f_2(x)
$$

的特解，则 $y_1^*(x) + y_2^*(x)$ 就是原方程的特解。（可推广到 $n$ 阶）

## 特征方程法

这个方法可以用来求 $n$ 阶常系数齐次线性微分方程的通解。

由于 $y=e^{rx}$ 和它的各阶导数都只相差一个常数因子，所以希望找到合适的常数 $r$ 使该函数满足方程。找到 $n$ 个线性无关的特解后就能构造出通解。

---

对于二阶常系数齐次线性微分方程

$$
y'' + p\,y'+q\,y = 0
$$

其中 $p, q$ 为常数。可以按如下步骤求出通解：

1. 写出特征方程。

    $$
    r^2 + p\,r + q = 0
    $$

2. 求出特征方程的两个根 $r_1, r_2$。

3. 按下表写出通解。

| 特征方程的根 $r_1, r_2$          | 通解                                                           |
| :------------------------- | :----------------------------------------------------------- |
| 两个不相等的实根                   | $y = C_1\,e^{r_1\,x} + C_2\,e^{r_2\,x}$                      |
| 两个相等的实根                    | $y = (C_1 + C_2\,x)\,e^{r_1\,x}$                             |
| 一对共轭复根 $\alpha\pm\beta\,i$ | $y = e^{\alpha\,x}\,(C_1\,\cos\beta\,x + C_2\,\sin\beta\,x)$ |

### 推广

对于 $n$ 阶常系数齐次线性微分方程

$$
y^{(n)} + p_1y^{(n - 1)} + \cdots + p_{n - 1}y' + p_ny = 0
$$

其中 $p_1, \cdots, p_{n - 1}, p_n$ 都为常数。可以按如下步骤求出通解：

1. 写出特征方程。

    $$
    r^n + p_1r^{n - 1} + \cdots + p_{n - 1}r + p_n = 0
    $$

2. 求出特征方程的 $n$ 个根 $r_1, \cdots, r_{n - 1}, r_n$。

3. 按下表写出通解。

|特征方程的根                                    |微分方程通解中的对应项                                                |
|:---------------------------------------------|:-----------------------------------------------------------------|
|单实根 $r$                                     |给出一项： $Ce^{rx}$                                                |
|一对单复根 $r_{1, 2} = \alpha\pm\beta\,i$       |给出两项： $e^{\alpha\,x}\,(C_1\,\cos\beta\,x + C_2\,\sin\beta\,x)$ |
| $k$ 重实根 $r$                                |给出 $k$ 项： $e^{rx}(C_1 + C_2x + \cdots + C_kx^{k - 1})$          |
|一对 $k$ 重复根 $r_{1, 2} = \alpha\pm\beta\,i$  |给出 $2k$ 项： $e^{\alpha\,x}\,\left[(C_1 + C_2x + \cdots + C_kx^{k - 1})\,\cos\beta\,x + (D_1 + D_2x + \cdots + D_kx^{k - 1})\,\sin\beta\,x\right]$ |

## 常数变易法

这个方法可以用来求 $n$ 阶非齐次线性微分方程的通解。

将原方程对应的齐次方程的通解中的任意常数替换为新的未知函数，再回带到原方程确定未知函数，最终得到原方程的通解。

---

对于一阶非齐次线性微分方程

$$
\dfrac{\mathrm{d}y}{\mathrm{d}x} + P(x)y = Q(x)
$$

对应的齐次方程

$$
\dfrac{\mathrm{d}y}{\mathrm{d}x} + P(x)y = 0
$$

的通解为

$$
y = Ce^{-\int P(x)\,\mathrm{d}x}
$$

那么，可以令原方程的通解为

$$
y = u(x)e^{-\int P(x)\,\mathrm{d}x}
$$

于是

$$
\dfrac{\mathrm{d}y}{\mathrm{d}x} = u'e^{-\int P(x)\,\mathrm{d}x} - uP(x)e^{-\int P(x)\,\mathrm{d}x}
$$

带入原方程可得

$$
u' = Q(x)e^{\int P(x)\,\mathrm{d}x}
$$

两端积分后可得 $u(x)$ 。所以原方程通解为

$$
y = e^{-\int P(x)\,\mathrm{d}x}\left(\int Q(x)e^{\int P(x)\,\mathrm{d}x}\,\mathrm{d}x + C\right)
$$

其中 $C$ 为任意常数。

---

对于二阶非齐次线性微分方程

$$
y'' + P(x)y' + Q(x)y = f(x)
$$

如果已知对应的齐次方程

$$
y'' + P(x)y' + Q(x)y = 0
$$

的通解为

$$
Y(x) = C_1\,y_1(x) + C_2\,y_2(x)
$$

那么，可以令

$$
y = v_1(x)\,y_1(x) + v_2(x)\,y_2(x)
$$

接下来，需要解一个关于 $v_1', v_2'$ 的二元线性方程组

$$
\left\{\begin{matrix}
  y_1\,v_1' + y_2\,v_2' = 0 \\
  y_1'\,v_1' + y_2'\,v_2' = f
\end{matrix}\right.
$$

> [!note]- 关于这个方程组
>
> 因为两个未知函数 $v_1$ 和 $v_2$ 只需使 $y$ 满足一个关系式（原方程），所以可以规定它们再满足一个关系式。由于
>
> $$
> y' = y_1v_1' + y_2v_2' + y_1'v_1 + y_2'v_2
> $$
>
> 为了使 $y''$ 的表示中不含 $v_1''$ 和 $v_2''$ ，可以设
>
> $$
> y_1\,v_1' + y_2\,v_2' = 0
> $$
>
> 在这个条件下，将 $y, y', y''$ 带入原方程可得
>
> $$
> y_1'\,v_1' + y_2'\,v_2' = f
> $$

如果系数行列式

$$
W =
\begin{vmatrix}
  y_1& y_2\\
  y_1'& y_2'
\end{vmatrix}
= y_1\,y_2' - y_1'\,y_2 \ne 0
$$

那么可以解得

$$
v_1' = -\dfrac{y_2\,f}{W}, v_2' = \dfrac{y_1\,f}{W}
$$

假设 $f(x)$ 连续，对上面两式积分可得 $v_1, v_2$。于是，原方程通解为

$$
y = C_1\,y_1 + C_2\,y_2 - y_1 \int \dfrac{y_2\,f}{W}\,\mathrm{d}x + y_2 \int \dfrac{y_1\,f}{W}\,\mathrm{d}x
$$

其中 $C_1, C_2$ 是任意常数。

## 待定系数法

这个方法可以用来求 $n$ 阶常系数非齐次线性微分方程的通解。

原方程对应的齐次方程的通解可以用特征方程求得，所以只需要猜出原方程的一个特解就能构造出通解。

---

对于二阶常系数非齐次线性微分方程

$$
y'' + py' + qy = f(x)
$$

其中 $p, q$ 是常数。设它的一个特解为 $y^*$。

### 情况 1

$$
f(x) = e^{\lambda\,x} \, P_m(x)
$$

其中 $\lambda$ 是常数， $P_m(x)$ 是 $x$ 的一个 $m$ 次多项式：

$$
P_m(x) = a_0x^m + a_1x^{m - 1} + \cdots + a_{m - 1}x + a_m
$$

那么可以设

$$
y^* = x^kR_m(x)e^{\lambda x}
$$

其中 $R_m(x)$ 是 $x$ 的一个 $m$ 次多项式，而 $k$ 的取值如下：

* $\lambda$ 不是特征方程的根， $k = 0$ 。
* $\lambda$ 是特征方程的单根， $k = 1$ 。
* $\lambda$ 是特征方程的重根， $k = 2$ 。

将 $y^*$ 带回原方程，对比系数就能求出该特解。

#### 推广

推广到 $n$ 阶后， $k$ 是特征方程含根 $\lambda$ 的重复次数。

* 若 $\lambda$ 不是特征方程的根， $k = 0$ 。
* 若 $\lambda$ 是特征方程的 $s$ 重根， $k = s$ 。

### 情况 2

$$
f(x) = e^{\lambda\,x} \, \left [P_l(x)\cos\omega\,x + Q_n(x)\sin\omega\,x \right ]
$$

其中

* $\lambda, \omega$ 是常数， $\omega \ne 0$ 。
* $P_l(x)$ 和 $Q_n(x)$ 分别是 $x$ 的 $l$ 次和 $n$ 次多项式。
* $P_l(x)$ 和 $Q_n(x)$ 中仅有一个可为零。

那么可以设

$$
y^* = x^ke^{\lambda x}[R_m^{(1)}(x)\cos\omega\,x + R_m^{(2)}(x) \sin\omega\,x]
$$

其中 $R_m^{(1)}(x)$ 和 $R_m^{(2)}(x)$ 是 $x$ 的 $m$ 次多项式， $m = \max\{l, n\}$，而 $k$ 的取值如下：

* $\lambda + \omega\,i$ （或 $\lambda - \omega\,i$ ）不是特征方程的根， $k = 0$ 。
* $\lambda + \omega\,i$ （或 $\lambda - \omega\,i$ ）是特征方程的单根， $k = 1$ 。

将 $y^*$ 带回原方程，对比系数就能求出该特解。

#### 推广

推广到 $n$ 阶后， $k$ 是特征方程含根 $\lambda + \omega\,i$ （或 $\lambda - \omega\,i$ ）的重复次数。
