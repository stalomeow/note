---
slug: "240528173226"
date: 2024-05-28
---

# 欧拉函数（数论）

欧拉函数 $\varphi(n)$ 也称为欧拉总计函数（Euler's totient function），是小于等于 $n$ 的正整数中与 $n$ 互质的数的数目。

将正整数 $n$ 分解为若干个互不相同的质因数 $p_i$ 的乘积

$$
n = p_1^{k_1} p_2^{k_2} \cdots p_r^{k_r}
$$

则

$$
\varphi(n) = n \prod_{i=1}^{r} \left (1 - \frac{1}{p_i} \right )
$$

## 证明

这个公式的证明是从特殊情况开始不断一般化得到的。

### 情况 1

当 $n=1$ 时

$$
\varphi(1)=1
$$

### 情况 2

当 $n$ 为质数时，$n$ 和小于它的每个数都互质，所以

$$
\varphi(n)=n-1
$$

### 情况 3

当 $n=p^k$ 且 $p$ 为质数时，小于等于 $p^k$ 的数中

$$
1 \times p, \ 2 \times p, \ 3 \times p, \dots, \ p^{k-1} \times p
$$

这 $p^{k-1}$ 个数是有因子 $p$ 的，$p^k$ 和它们以外的数互质，所以

$$
\varphi(p^k)=p^k - p^{k-1}
$$

### 情况 4

当 $n=pq$ 且 $p,q$ 互质时，设 $0<N<pq$ 且 $N$ 与 $pq$ 互质，那么 $\varphi(pq)$ 就等于 $N$ 的个数。

令

$$
N=k_1p+a_1=k_2q+a_2
$$

其中 $0<a_1 \le p$ 且 $0<a_2 \le q$。设 $d$ 是 $p,a_1$ 的公约数，根据[[整除]]的性质

$$
d \mid p \wedge d \mid a_1 \Longrightarrow d \mid (k_1p+a_1)
$$

所以 $p,a_1$ 的公约数也是 $p,N$ 的公约数，但因为 $pq$ 与 $N$ 互质，所以 $p$ 与 $N$ 也互质，故 $p,a_1$ 也只能互质。反过来，$p,a_1$ 互质时，$p,N$ 也互质。

同理 $q,a_2$ 也互质。那么，满足条件的 $a_1,a_2$ 的个数分别为 $\varphi(p),\varphi(q)$ 个。

由[[中国剩余定理]]，方程组

$$
\left\{\begin{matrix}
N \equiv a_1 \pmod{p} \\
N \equiv a_2 \pmod{q}
\end{matrix}\right.
$$

通解 $N$ 表示为

$$
N=kpq + a_1 t_1 q + a_2 t_2 p, k \in \mathbb{Z} \tag{1}
$$

其中 $t_1,t_2$ 是固定的整数。

当给定 $a_1,a_2$ 时，$(1)$ 式是周期为 $pq$ 的序列，只存在唯一的 $k$ 使得 $0<N<pq$，所以 $N$ 与 $(a_1,a_2)$ 一一对应。由乘法原理，二元组 $(a_1,a_2)$ 有 $\varphi(p)\varphi(q)$ 个，所以

$$
\varphi(pq)=\varphi(p)\varphi(q)
$$

