---
slug: "240530230756"
date: 2024-05-30
---

# 扩展欧拉定理（数论）

扩展欧拉定理是将[[欧拉定理（数论）|欧拉定理]]扩展到 $a,n$ 不互质的情况，公式为

$$
a^b \equiv a^{(b \bmod \varphi(n)) + \varphi(n)} \pmod{n}
$$

写成分段的形式为

$$
a^b \equiv \left\{\begin{array}{l}
a^{b \bmod \varphi(n)} & \gcd(a,n)=1 \\
a^{b} & \gcd(a,n) \ne 1 \wedge b < \varphi(n) \\
a^{(b \bmod \varphi(n)) + \varphi(n)} & \gcd(a,n) \ne 1 \wedge b \ge \varphi(n)
\end{array}\right. \pmod{n} 
$$

在 $b$ 很大时，可以用这个公式来 ==降幂==。

## 证明

$$
a^b = a^{\left\lfloor b/\varphi(n) \right\rfloor \varphi(n) + (b \bmod \varphi(n))}
$$

### 情况 1

当 $\gcd(a,n)=1$ 时，由[[欧拉定理（数论）]]

$$
a^b \equiv \left( a^{\varphi(n)} \right)^{\left\lfloor b/\varphi(n) \right\rfloor} \times a^{b \bmod \varphi(n)} \equiv a^{b \bmod \varphi(n)} \pmod{n}
$$

### 情况 2

当 $\gcd(a,n) \ne 1 \wedge b < \varphi(n)$ 时，$b$ 不算很大，直接硬算

$$
a^b \bmod n
$$


### 情况 3

当 $\gcd(a,n) \ne 1 \wedge b \ge \varphi(n)$ 时，根据[[算术基本定理]]将 $n$ 分解成质因数的乘积

$$
n = p_1^{k_1} p_2^{k_2} \cdots p_r^{k_r}
$$

然后，对于每个 $p_i^{k_i}$ 进一步讨论。

#### 情况 3-1

当 $\gcd(a,p_i^{k_i})=1$ 时，因为[[欧拉函数（数论）|欧拉函数]]是[[积性函数]]，所以

$$
\varphi(p_i^{k_i}) \mid \varphi(n)
$$

因此

$$
a^{\varphi(n)} \equiv \left( a^{\varphi(p_i^{k_i})} \right)^{\varphi(n)/\varphi(p_i^{k_i})} \equiv 1 \pmod{p_i^{k_i}}
$$

故

$$
a^b \equiv \left( a^{\varphi(n)} \right)^{\left\lfloor b/\varphi(n) \right\rfloor} \times a^{b \bmod \varphi(n)} \times a^{\varphi(n)} \equiv  a^{(b \bmod \varphi(n)) + \varphi(n)} \pmod{p_i^{k_i}}
$$


#### 情况 3-2

当 $\gcd(a,p_i^{k_i}) \ne 1$ 时，注意到

$$
\varphi(p_i^{k_i}) = p_i^{k_i-1}(p_i - 1) \ge k_i
$$

所以

$$
b \ge \varphi(n) \ge \varphi(p_i^{k_i}) \ge k_i
$$


$a$ 一定是 $p_i$ 的倍数，所以设 $a=mp_i$。

